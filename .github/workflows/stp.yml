name: CI

on: [push]

jobs:
  build:

    runs-on: macOS-latest

    steps:
    - uses: actions/checkout@v1
    - uses: actions/setup-ruby@v1
      with:
        ruby-version: '2.6.x'
    - run: |
        system_profiler SPHardwareDataType SPSoftwareDataType SPSerialATADataType
        sudo sqlite3 /var/db/auth.db .dump | grep "safaridriver"
    - run: |
        brew tap homebrew/cask-versions
        brew cask install safari-technology-preview
        sudo /Applications/Safari\ Technology\ Preview.app/Contents/MacOS/safaridriver --enable
        sudo /Applications/Safari\ Technology\ Preview.app/Contents/MacOS/safaridriver --port 0 &
    - run: |
        pip3 install selenium
        echo start...
        sudo python3 stp.py
